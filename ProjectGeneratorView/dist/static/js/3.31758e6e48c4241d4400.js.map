{"version":3,"sources":["webpack:///./src/api/projectPhase.js","webpack:///./src/views/phase/create.vue?6170","webpack:///./src/api/project.js","webpack:///./src/views/phase/create.vue?338f","webpack:///src/views/phase/create.vue","webpack:///./src/views/phase/create.vue?0def","webpack:///./src/views/phase/create.vue","webpack:///./src/api/projectCustomer.js"],"names":["__webpack_require__","d","__webpack_exports__","addProjectPhase","getProjectPhaseList","getProjectPhaseTotal","updatePhase","deletePhase","_utils_request__WEBPACK_IMPORTED_MODULE_0__","projectPhase","request","url","method","data","projectId","params","phaseId","phase","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_dist_cjs_js_ref_6_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_2_node_modules_vue_loader_lib_index_js_vue_loader_options_create_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","n","a","JNL0","t","e","r","getAllProjects","getProjectById","getProjectDetailById","addProject","updateProject","deleteProject","deleteRateRange","getRateRange","project","rateRangeId","investMoney","s","o","c","defaultForm","establishTime","payTime","customerInPhaseList","phase_createvue_type_script_lang_js_","components","projectName","phaseForm","assign_default","btnLoading","investCustomerList","customerWithNameList","selectedCustomerList","rules","required","trigger","message","created","this","hasPermission","$route","id","getProjectName","getNewPhase","getInvestCustomersByProjectId","methods","_this","Object","then","response","returnCode","$message","error","_this2","submitForm","_this3","i","length","temp","customerIdCard","push","$refs","validate","valid","console","log","createPhase","_this4","projectCustomer","forEach","customer","index","name","getCustomerName","customerId","label","key","find","x","customerName","_this5","success","$router","catch","component","componentNormalizer","_vm","_h","$createElement","_c","_self","staticClass","attrs","span","offset","staticStyle","margin-top","shadow","slot","text-align","_v","_s","font-size","effect","type","to","float","padding","icon","ref","model","label-width","prop","domProps","textContent","width","placeholder","value-format","format","value","callback","$$v","$set","expression","filterable","filter-placeholder","titles","scopedSlots","_u","fn","option","content","placement","gutter","display","justify","on","click","$event","resetForm","loading","default","addProjectCustomer","getCustomersInProjectPhase","getCustomerInvestProject"],"mappings":"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","file":"static/js/3.31758e6e48c4241d4400.js","sourcesContent":["import request from '@/utils/request'\n\nexport function addProjectPhase(projectPhase) {\n  return request({\n    url: '/projectPhase/insert',\n    method: 'post',\n    data: projectPhase\n  })\n}\n\nexport function getProjectPhaseList(projectId) {\n  return request({\n    url: '/projectPhase/getProjectPhaseList',\n    method: 'get',\n    params: {projectId}\n  })\n}\n\nexport function getProjectPhaseTotal(projectId) {\n  return request({\n    url: '/projectPhase/getProjectPhaseTotal',\n    method: 'get',\n    params: {projectId}\n  })\n}\n\nexport function updatePhase(projectPhase) {\n  return request({\n    url: '/projectPhase/updatePhase',\n    method: 'post',\n    data: projectPhase\n  })\n}\n\nexport function deletePhase(phaseId,projectId,phase) {\n  return request({\n    url: '/projectPhase/deletePhase',\n    method: 'get',\n    params: {phaseId,projectId,phase}\n  })\n}\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--6-2!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./create.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--6-2!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./create.vue?vue&type=style&index=0&lang=css&\"","import request from '@/utils/request'\n\nexport function getAllProjects() {\n  return request({\n    url: '/project/getAllProjects',\n    method: 'get'\n  })\n}\n\nexport function getProjectById(projectId) {\n  return request({\n    url: '/project/getProjectById',\n    method: 'get',\n    params: {projectId}\n  })\n}\n\nexport function getProjectDetailById(projectId) {\n  return request({\n    url: '/project/getProjectDetailById',\n    method: 'get',\n    params: {projectId}\n  })\n}\n\nexport function addProject(project) {\n  return request({\n    url: '/project/insert',\n    method: 'post',\n    data: project\n  })\n}\n\nexport function updateProject(project) {\n  return request({\n    url: '/project/update',\n    method: 'post',\n    data: project\n  })\n}\n\nexport function deleteProject(projectId) {\n  return request({\n    url: '/project/deleteProjectById',\n    method: 'get',\n    params: {projectId}\n  })\n}\n\nexport function deleteRateRange(rateRangeId) {\n  return request({\n    url: '/rateRange/deleteRateRange',\n    method: 'get',\n    params: {rateRangeId}\n  })\n}\n\nexport function getRateRange(projectId,investMoney) {\n  return request({\n    url: '/rateRange/getRateRange',\n    method: 'get',\n    params: {projectId,investMoney}\n  })\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app-container\"},[_c('div',{staticClass:\"filter-container\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":22,\"offset\":1}},[_c('el-card',{staticStyle:{\"margin-top\":\"2%\"},attrs:{\"shadow\":\"hover\"}},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('h3',{staticStyle:{\"text-align\":\"center\"}},[_vm._v(_vm._s(_vm.projectName))]),_vm._v(\" \"),_c('el-tag',{staticStyle:{\"font-size\":\"16px\"},attrs:{\"effect\":\"dark\",\"type\":\"primary\"}},[_vm._v(\"新建一期\")]),_vm._v(\" \"),_c('router-link',{attrs:{\"to\":'/project/index'}},[_c('el-button',{staticStyle:{\"float\":\"right\",\"padding\":\"8px 10px\"},attrs:{\"type\":\"info\",\"icon\":\"el-icon-back\"}},[_vm._v(\"返回列表\")])],1)],1),_vm._v(\" \"),_c('div',[_c('el-form',{ref:\"phaseForm\",attrs:{\"model\":_vm.phaseForm,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"期数\",\"prop\":\"phase\"}},[_c('el-button',{domProps:{\"textContent\":_vm._s(_vm.phaseForm.phase)}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"成立时间\",\"prop\":\"establishTime\"}},[_c('el-row',[_c('el-col',{attrs:{\"span\":22}},[_c('div',{staticClass:\"block\"},[_c('el-date-picker',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"date\",\"placeholder\":\"选择日期\",\"value-format\":\"yyyy-MM-dd\",\"format\":\"yyyy-MM-dd\"},model:{value:(_vm.phaseForm.establishTime),callback:function ($$v) {_vm.$set(_vm.phaseForm, \"establishTime\", $$v)},expression:\"phaseForm.establishTime\"}})],1)])],1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"付款时间\",\"prop\":\"payTime\"}},[_c('el-row',[_c('el-col',{attrs:{\"span\":22}},[_c('div',{staticClass:\"block\"},[_c('el-date-picker',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"date\",\"placeholder\":\"选择日期\",\"value-format\":\"yyyy-MM-dd\",\"format\":\"yyyy-MM-dd\"},model:{value:(_vm.phaseForm.payTime),callback:function ($$v) {_vm.$set(_vm.phaseForm, \"payTime\", $$v)},expression:\"phaseForm.payTime\"}})],1)])],1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"选择客户\"}},[_c('el-transfer',{attrs:{\"filterable\":\"\",\"filter-placeholder\":\"请输入客户姓名\",\"titles\":['该项目投资客户', '该期客户'],\"data\":_vm.investCustomerList},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar option = ref.option;\nreturn _c('div',{},[_c('el-tooltip',{attrs:{\"effect\":\"dark\",\"content\":option.key,\"placement\":\"top-start\"}},[_c('el-row',{attrs:{\"gutter\":20,\"display\":\"flex\",\"justify\":\"space-between\"}},[_c('el-col',{attrs:{\"span\":10}},[_c('span',[_vm._v(_vm._s(option.label))])]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":10}},[_c('span',[_vm._v(_vm._s(option.phase))])])],1)],1)],1)}}]),model:{value:(_vm.selectedCustomerList),callback:function ($$v) {_vm.selectedCustomerList=$$v},expression:\"selectedCustomerList\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"warning\",\"icon\":\"el-icon-refresh-left\"},on:{\"click\":function($event){return _vm.resetForm('phaseForm')}}},[_vm._v(\"重置\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-check\",\"loading\":_vm.btnLoading},on:{\"click\":function($event){return _vm.submitForm()}}},[_vm._v(\"保存\\n                \")])],1)],1)],1)])],1)],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"app-container\">\n    <div class=\"filter-container\">\n      <el-row>\n        <el-col :span=\"22\" :offset=\"1\">\n          <el-card shadow=\"hover\" style=\"margin-top: 2%\">\n            <div slot=\"header\" class=\"clearfix\">\n              <h3 style=\"text-align:center\">{{projectName}}</h3>\n              <el-tag effect=\"dark\" type=\"primary\" style=\"font-size:16px\">新建一期</el-tag>\n              <router-link :to=\"'/project/index'\">\n                <el-button type=\"info\" style=\"float:right; padding: 8px 10px\" icon=\"el-icon-back\">返回列表</el-button>\n              </router-link>\n            </div>\n            <div>\n              <el-form :model=\"phaseForm\" :rules=\"rules\" ref=\"phaseForm\" label-width=\"100px\">\n                <el-form-item label=\"期数\" prop=\"phase\">\n                  <el-button v-text=\"phaseForm.phase\"/>\n                </el-form-item>\n                <el-form-item label=\"成立时间\" prop=\"establishTime\">\n                  <el-row>\n                    <el-col :span=\"22\">\n                      <div class=\"block\">\n                        <el-date-picker\n                          style=\"width:100%\"\n                          v-model=\"phaseForm.establishTime\"\n                          type=\"date\"\n                          placeholder=\"选择日期\"\n                          value-format=\"yyyy-MM-dd\" format=\"yyyy-MM-dd\">\n                        </el-date-picker>\n                      </div>\n                    </el-col>\n                  </el-row>\n                </el-form-item>\n                <el-form-item label=\"付款时间\" prop=\"payTime\">\n                  <el-row>\n                    <el-col :span=\"22\">\n                      <div class=\"block\">\n                        <el-date-picker\n                          style=\"width:100%\"\n                          v-model=\"phaseForm.payTime\"\n                          type=\"date\"\n                          placeholder=\"选择日期\"\n                          value-format=\"yyyy-MM-dd\" format=\"yyyy-MM-dd\">\n                        </el-date-picker>\n                      </div>\n                    </el-col>\n                  </el-row>\n                </el-form-item>\n                <el-form-item label=\"选择客户\">\n                  <el-transfer\n                      filterable\n                      filter-placeholder=\"请输入客户姓名\"\n                      :titles=\"['该项目投资客户', '该期客户']\"\n                      v-model=\"selectedCustomerList\"\n                      :data=\"investCustomerList\">\n                      <div slot-scope=\"{ option }\">\n                        <el-tooltip effect=\"dark\" :content=\"option.key\" placement=\"top-start\">\n                          <el-row :gutter=\"20\" display=\"flex\" justify=\"space-between\">\n                            <el-col :span=\"10\">\n                              <span>{{ option.label }}</span>\n                            </el-col>\n                            <el-col :span=\"10\" >\n                              <span>{{ option.phase }}</span>\n                            </el-col>\n                          </el-row>\n                        </el-tooltip>\n                      </div>\n                    </el-transfer>\n                </el-form-item>\n\n                <el-form-item>\n                  <el-button type=\"warning\" icon=\"el-icon-refresh-left\" @click=\"resetForm('phaseForm')\">重置</el-button>\n                  <el-button type=\"primary\" icon=\"el-icon-check\"\n                             :loading=\"btnLoading\"\n                             @click=\"submitForm()\">保存\n                  </el-button>\n                </el-form-item>\n              </el-form>\n            </div>\n          </el-card>\n        </el-col>\n      </el-row>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { getProjectById } from '@/api/project'\n  import { addProjectPhase, getProjectPhaseTotal } from '@/api/projectPhase'\n  import { getCustomersInProjectPhase, getInvestCustomersByProjectId } from '@/api/projectCustomer'\n\n  const defaultForm = {\n    phaseId: '',\n    projectId: '',\n    phase: '',\n    establishTime: '',\n    payTime: '',\n    customerInPhaseList:[],\n  };\n\n  export default {\n    components: {},\n    data() {\n      return {\n        projectId: '',\n        projectName: '',\n        phaseForm: Object.assign({}, defaultForm),\n        btnLoading: false,\n        investCustomerList: [],  // 所有投资了该项目的客户\n        customerInPhaseList: [], // 已经录入了某一期的客户列表\n        customerWithNameList: [], //用于获取客户姓名\n        selectedCustomerList: [],\n        rules: {\n          establishTime: [{required: true, trigger: 'blur', message: \"请选择该期成立时间\"}],\n          payTime: [{required: true, trigger: 'blur', message: \"请选择付息时间\"}],\n        },\n      };\n    },\n    created() {\n      if (this.hasPermission('phase:insert')) {\n        this.projectId = this.$route.params && this.$route.params.id;\n        this.phaseForm = Object.assign({}, defaultForm);\n        this.getProjectName(this.projectId);\n        this.getNewPhase(this.projectId);\n        this.getInvestCustomersByProjectId(this.projectId);\n      }\n    },\n    methods: {\n      getProjectName(projectId){\n        getProjectById(projectId).then(response => {\n          if (response.returnCode === 200) {\n            this.projectName = response.data.projectName;\n          }else{\n            this.$message.error('获取项目名称失败，请刷新');\n          }\n        });\n      },\n      getNewPhase(projectId) {\n        getProjectPhaseTotal(projectId).then(response => {\n          if (response.returnCode === 200) {\n            this.phaseForm.phase = response.data + 1;\n          } else {\n            this.$message.error(\"获取项目期数失败，请刷新重试\");\n          }\n        })\n      },\n      submitForm() {\n        this.phaseForm.projectId = this.projectId;\n        let customerInPhaseList = [];\n        for (let i = 0; i < this.selectedCustomerList.length; i++) {\n          let temp = {\n            id: '',\n            phase: this.phaseForm.phase,\n            projectId: this.projectId,\n            customerIdCard: this.selectedCustomerList[i]\n          };\n          customerInPhaseList.push(temp)\n        }\n        this.phaseForm.customerInPhaseList = customerInPhaseList;\n        this.$refs.phaseForm.validate(valid => {\n          if (valid) {\n            this.createPhase(this.phaseForm);\n          } else {\n            console.log('error submit!!');\n            return false;\n          }\n        })\n      },\n      getInvestCustomersByProjectId(projectId) {\n        getCustomersInProjectPhase(projectId, -1).then(response => {\n          this.customerInPhaseList = response.data;\n          getInvestCustomersByProjectId(projectId).then(response => {\n            if (response.returnCode === 200) {\n              this.customerWithNameList = response.data;\n              this.customerInPhaseList.forEach((customer, index) => {\n                let name = this.getCustomerName(customer.customerId)\n                this.investCustomerList.push({\n                  label: name,\n                  phase: customer.phase !== -1? '第' + customer.phase + '期':'未录入',\n                  key: customer.customerIdCard,\n                });\n              });\n            } else {\n              this.$message.error(\"获取客户列表失败，请刷新重试\");\n            }\n          })\n        });\n      },\n      getCustomerName(customerId){\n        let customer = this.customerWithNameList.find(function (x) {\n          return x.customerId === customerId\n        });\n        return customer.customerName\n      },\n      createPhase(phase) {\n        this.btnLoading = true;\n        addProjectPhase(phase).then((response) => {\n          if (response.returnCode === 200) {\n            this.$message.success('新建成功');\n            this.$router.push({name: '期数管理', params: {projectId: this.projectId}});\n            this.btnLoading = false\n          } else {\n            this.$message.error(response.message);\n            console.error(response);\n            this.btnLoading = false\n          }\n        }).catch(error => {\n          console.error(error);\n          this.$message.error(error.message);\n          this.btnLoading = false\n        });\n      }\n    }\n  }\n</script>\n\n<style>\n\n  .clearfix:before,\n  .clearfix:after {\n    display: table;\n    content: \"\";\n  }\n  .clearfix:after {\n    clear: both\n  }\n\n   .el-transfer-panel{\n     width: 40%;\n     height: 400px\n   }\n  .el-transfer-panel__list.is-filterable{\n    height: 100%;\n  }\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./create.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./create.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./create.vue?vue&type=template&id=6b5694a5&\"\nimport script from \"./create.vue?vue&type=script&lang=js&\"\nexport * from \"./create.vue?vue&type=script&lang=js&\"\nimport style0 from \"./create.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\n\nexport function addProjectCustomer(projectCustomer) {\n  return request({\n    url: '/projectCustomer/insert',\n    method: 'post',\n    data: projectCustomer\n  })\n}\n\nexport function getInvestCustomersByProjectId(projectId) {\n  return request({\n    url: '/projectCustomer/getInvestCustomersByProjectId',\n    method: 'get',\n    params: {projectId}\n  })\n}\n\nexport function getCustomersInProjectPhase(projectId,phase) {\n  return request({\n    url: '/projectCustomer/getCustomersInProjectPhase',\n    method: 'get',\n    params: {projectId,phase}\n  })\n}\n\nexport function getCustomerInvestProject(customerId) {\n  return request({\n    url: '/projectCustomer/getCustomerInvestProject',\n    method: 'get',\n    params: {customerId}\n  })\n}\n\n"],"sourceRoot":""}