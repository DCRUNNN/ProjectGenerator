(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"9rC1":function(e,t,o){"use strict";o.d(t,"c",function(){return s}),o.d(t,"a",function(){return n}),o.d(t,"d",function(){return i}),o.d(t,"b",function(){return a});var r=o("t3Un");function s(e){return Object(r.a)({url:"/customer/listAllCustomers",method:"get",params:e})}function n(e){return Object(r.a)({url:"/customer/insert",method:"post",data:e})}function i(e){return Object(r.a)({url:"/customer/update",method:"post",data:e})}function a(e){return Object(r.a)({url:"/customer/deleteCustomerById",method:"get",params:{customerId:e}})}},JAiP:function(e,t,o){"use strict";var r=o("tqKs");o.n(r).a},Yfch:function(e,t,o){"use strict";function r(e){return/^ROLE_[A-Z]+$/.test(e)}function s(e){return!0}function n(e){return!0}function i(e){return/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(e)}o.d(t,"d",function(){return r}),o.d(t,"c",function(){return s}),o.d(t,"a",function(){return n}),o.d(t,"b",function(){return i})},rt9V:function(e,t,o){"use strict";o.r(t);var r=o("9rC1"),s=o("Yfch"),n=(o("L2JU"),{components:{},name:"CustomerList",data:function(){return{search:"",customerList:[],listLoading:!1,total:0,listQuery:{page:1,size:10},dialogStatus:"add",dialogFormVisible:!1,textMap:{update:"更新客户信息",add:"新增客户"},btnLoading:!1,readonly:!1,customerExist:!1,tempCustomer:{customerId:"",customerName:"",idCard:"",bankAccount:"",phoneNumber:""},createRules:{customerName:[{required:!0,trigger:"blur",message:"请输入客户姓名"}],idCard:[{required:!0,trigger:"blur",validator:function(e,t,o){Object(s.b)(t)?o():o(new Error("id card format error"))}}],bankAccount:[{required:!0,trigger:"blur",message:"请输入客户银行账号"}],phoneNumber:[{required:!0,trigger:"blur",message:"请输入客户联系方式"}]}}},created:function(){this.hasPermission("customer:list")&&this.getAllCustomersList()},methods:{refresh:function(){this.getAllCustomersList(),this.$message.success("已是最新")},getAllCustomersList:function(){var e=this;this.listLoading=!0,Object(r.c)(this.listQuery).then(function(t){e.customerList=t.data.list,e.total=t.data.total,e.listLoading=!1})},addCustomer:function(){var e=this;this.$refs.tempCustomer.validate(function(t){t&&(e.btnLoading=!0,Object(r.a)(e.tempCustomer).then(function(t){200===t.returnCode?(e.$message.success("录入客户信息成功"),e.getAllCustomersList(),e.dialogFormVisible=!1,e.btnLoading=!1):(e.$message.error(t.message),console.error(t),e.btnLoading=!1)}).catch(function(t){console.error(t),e.btnLoading=!1}))})},updateCustomer:function(){var e=this;this.$refs.tempCustomer.validate(function(t){t&&(e.btnLoading=!0,Object(r.d)(e.tempCustomer).then(function(t){200===t.returnCode?(e.$message.success("更新客户信息成功！"),e.getAllCustomersList(),e.dialogFormVisible=!1,e.btnLoading=!1):(e.$message.error(t.message),console.error(t),e.btnLoading=!1)}).catch(function(t){e.$message.error(t.message),console.error(t),e.btnLoading=!1}))})},deleteCustomer:function(e,t){var o=this;this.$confirm("您确认要删除客户 "+e+" 的信息吗?","Warning",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.b)(t).then(function(e){200===e.returnCode?(o.$message.success("删除客户信息成功！"),o.getAllCustomersList()):(o.$message.error(e.message),o.getAllCustomersList())}).catch(function(e){o.$message.error(e.message),console.error(e)})})},handleSizeChange:function(e){this.listQuery.size=e,this.listQuery.page=1,this.getAllCustomersList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getAllCustomersList()},showAddCustomerDialog:function(){this.dialogFormVisible=!0,this.dialogStatus="add",this.tempCustomer.customerName="",this.tempCustomer.idCard="",this.tempCustomer.bankAccount="",this.tempCustomer.phoneNumber="",this.readonly=!1},showUpdateCustomerDialog:function(e){this.dialogFormVisible=!0,this.dialogStatus="update",this.tempCustomer.customerId=e.customerId,this.tempCustomer.customerName=e.customerName,this.tempCustomer.idCard=e.idCard,this.tempCustomer.bankAccount=e.bankAccount,this.tempCustomer.phoneNumber=e.phoneNumber}}}),i=(o("JAiP"),o("KHd+")),a=Object(i.a)(n,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"filter-container"},[o("el-form",[o("el-form-item",[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:6}},[e.hasPermission("customer:list")?o("el-button",{attrs:{type:"success",icon:"el-icon-refresh",size:"medium"},nativeOn:{click:function(t){return t.preventDefault(),e.refresh(t)}}},[e._v("刷新\n            ")]):e._e(),e._v(" "),e.hasPermission("customer:insert")?o("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"medium"},nativeOn:{click:function(t){return t.preventDefault(),e.showAddCustomerDialog(t)}}},[e._v("新增\n            ")]):e._e()],1),e._v(" "),o("el-col",{attrs:{span:8,offset:10}},[o("el-input",{attrs:{size:"medium",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1)],1)],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.customerList.filter(function(t){return!e.search||t.customerName.toLowerCase().includes(e.search.toLowerCase())||t.idCard.includes(e.search)||t.bankAccount.includes(e.search)||t.phoneNumber.includes(e.search)}),"element-loading-text":"全力加载中...",border:"",fit:"","highlight-current-row":""}},[o("el-table-column",{attrs:{label:"姓名",align:"center",sortable:"",prop:"customerName"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"el-icon-user"}),e._v(" "),o("span",{domProps:{textContent:e._s(t.row.customerName)}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"身份证号",align:"center",sortable:"",prop:"idCard"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"el-icon-document"}),e._v(" "),o("span",{domProps:{textContent:e._s(t.row.idCard)}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"银行账户",align:"center",sortable:"",prop:"bankAccount"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"el-icon-bank-card"}),e._v(" "),o("span",{domProps:{textContent:e._s(t.row.bankAccount)}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"联系方式",align:"center",sortable:"",prop:"phoneNumber"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"el-icon-mobile-phone"}),e._v(" "),o("span",{domProps:{textContent:e._s(t.row.phoneNumber)}})]}}])}),e._v(" "),e.hasPermission("customer:update")||e.hasPermission("customer:delete")?o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasPermission("customer:update")?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit-outline circle"},nativeOn:{click:function(o){return o.preventDefault(),e.showUpdateCustomerDialog(t.row)}}},[e._v("更新\n        ")]):e._e(),e._v(" "),e.hasPermission("customer:delete")?o("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},nativeOn:{click:function(o){return o.preventDefault(),e.deleteCustomer(t.row.customerName,t.row.customerId)}}},[e._v("删除\n        ")]):e._e()]}}])}):e._e()],1),e._v(" "),o("div",{staticClass:"pagination-container"},[o("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-size":e.listQuery.size,total:e.total,"page-sizes":[10,30,50,100],background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),o("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"tempCustomer",staticClass:"small-space",staticStyle:{width:"500px","margin-left":"40px"},attrs:{"status-icon":"","label-position":"left","label-width":"100px",model:e.tempCustomer,rules:e.createRules}},[o("el-form-item",{attrs:{label:"客户姓名",prop:"customerName"}},[o("el-input",{attrs:{type:"text","prefix-icon":"el-icon-info","auto-complete":"off",readonly:e.readonly},model:{value:e.tempCustomer.customerName,callback:function(t){e.$set(e.tempCustomer,"customerName",t)},expression:"tempCustomer.customerName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"身份证号",prop:"idCard"}},[o("el-input",{attrs:{type:"text","prefix-icon":"el-icon-edit","auto-complete":"off",readonly:e.readonly},model:{value:e.tempCustomer.idCard,callback:function(t){e.$set(e.tempCustomer,"idCard",t)},expression:"tempCustomer.idCard"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"银行账户",prop:"bankAccount"}},[o("el-input",{attrs:{type:"text","prefix-icon":"el-icon-edit-outline","auto-complete":"off",readonly:e.readonly},model:{value:e.tempCustomer.bankAccount,callback:function(t){e.$set(e.tempCustomer,"bankAccount",t)},expression:"tempCustomer.bankAccount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"联系电话",prop:"phoneNumber"}},[o("el-input",{attrs:{type:"text","prefix-icon":"el-icon-mobile-phone","auto-complete":"off",readonly:e.readonly},model:{value:e.tempCustomer.phoneNumber,callback:function(t){e.$set(e.tempCustomer,"phoneNumber",t)},expression:"tempCustomer.phoneNumber"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{float:"left"},attrs:{icon:"el-icon-error"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),"add"===e.dialogStatus?o("el-button",{staticStyle:{float:"left"},attrs:{type:"danger",icon:"el-icon-refresh"},on:{click:function(t){return e.$refs.tempCustomer.resetFields()}}},[e._v("重置\n      ")]):e._e(),e._v(" "),"add"===e.dialogStatus?o("el-button",{attrs:{type:"success",loading:e.btnLoading,icon:"el-icon-success"},nativeOn:{click:function(t){return t.preventDefault(),e.addCustomer(t)}}},[e._v("添加\n      ")]):o("el-button",{attrs:{type:"primary",loading:e.btnLoading,icon:"el-icon-success"},nativeOn:{click:function(t){return t.preventDefault(),e.updateCustomer()}}},[e._v("更新\n      ")])],1)],1)],1)},[],!1,null,"20ba8d5c",null);t.default=a.exports},tqKs:function(e,t,o){}}]);
//# sourceMappingURL=7.e6fd935d429688a2d803.js.map