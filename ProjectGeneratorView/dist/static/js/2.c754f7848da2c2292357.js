(window.webpackJsonp=window.webpackJsonp||[]).push([[2,16],{"9rC1":function(t,e,r){"use strict";r.d(e,"c",function(){return o}),r.d(e,"a",function(){return s}),r.d(e,"d",function(){return i}),r.d(e,"b",function(){return a});var n=r("t3Un");function o(t){return Object(n.a)({url:"/customer/listAllCustomers",method:"get",params:t})}function s(t){return Object(n.a)({url:"/customer/insert",method:"post",data:t})}function i(t){return Object(n.a)({url:"/customer/update",method:"post",data:t})}function a(t){return Object(n.a)({url:"/customer/deleteCustomerById",method:"get",params:{customerId:t}})}},JNL0:function(t,e,r){"use strict";r.d(e,"d",function(){return o}),r.d(e,"e",function(){return s}),r.d(e,"f",function(){return i}),r.d(e,"a",function(){return a}),r.d(e,"h",function(){return c}),r.d(e,"b",function(){return u}),r.d(e,"c",function(){return l}),r.d(e,"g",function(){return d});var n=r("t3Un");function o(){return Object(n.a)({url:"/project/getAllProjects",method:"get"})}function s(t){return Object(n.a)({url:"/project/getProjectById",method:"get",params:{projectId:t}})}function i(t){return Object(n.a)({url:"/project/getProjectDetailById",method:"get",params:{projectId:t}})}function a(t){return Object(n.a)({url:"/project/insert",method:"post",data:t})}function c(t){return Object(n.a)({url:"/project/update",method:"post",data:t})}function u(t){return Object(n.a)({url:"/project/deleteProjectById",method:"get",params:{projectId:t}})}function l(t){return Object(n.a)({url:"/rateRange/deleteRateRange",method:"get",params:{rateRangeId:t}})}function d(t,e){return Object(n.a)({url:"/rateRange/getRateRange",method:"get",params:{projectId:t,investMoney:e}})}},PbIS:function(t,e,r){},W0Vi:function(t,e,r){"use strict";var n=r("PbIS");r.n(n).a},WLgR:function(t,e,r){"use strict";r.r(e);var n={name:"CreateInvestForm",components:{InvestDetail:r("WlOQ").default}},o=r("KHd+"),s=Object(o.a)(n,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-container"},[e("div",{staticClass:"filter-container"},[e("invest-detail",{attrs:{"is-edit":!1}})],1)])},[],!1,null,null,null);e.default=s.exports},WlOQ:function(t,e,r){"use strict";r.r(e);var n=r("ql3t"),o=r.n(n),s=r("P2sY"),i=r.n(s),a=r("9rC1"),c=r("i7jY"),u=r("JNL0"),l={id:"",customerId:"",projectId:"",phase:-1,customerIdCard:"",investMoney:"",investTime:"",rate:""},d={name:"ProjectCustomerDetail",components:{},props:{isEdit:{type:Boolean,default:!1}},watch:{"investForm.customerId":{handler:function(t,e){if(t){this.getCustomerInvestProjectList(t);var r=this.allCustomerList.find(function(e){return e.customerId===t});this.investForm.customerIdCard=r.idCard}},deep:!0},"investForm.projectId":{handler:function(t,e){this.getRateRange()},deep:!0},"investForm.investMoney":{handler:function(t,e){this.getRateRange()},deep:!0}},data:function(){return{allProjectList:[],allCustomerList:[],customerInvestProjectList:[],investForm:i()({},l),btnLoading:!1,rules:{customerId:[{required:!0,message:"请选择投资人",trigger:"blur"}],customerIdCard:[{required:!0,message:"若投资人身份证号为空，请联系管理员",trigger:"blur"}],projectId:[{required:!0,message:"请选择投资项目",trigger:"blur"}],investMoney:[{required:!0,message:"请输入投资金额",trigger:"blur"},{type:"number",message:"投资金额必须为数字值"}],investTime:[{required:!0,message:"请选择投资时间",trigger:"blur"}]}}},created:function(){this.hasPermission("project:list")&&(this.isEdit||(this.investForm=i()({},l),this.getAllProjectsList(),this.getAllCustomersList()))},methods:{getAllProjectsList:function(){var t=this;Object(u.d)().then(function(e){var r=e.data;r.forEach(function(t){return t.disabled=!1}),t.allProjectList=r})},getAllCustomersList:function(){var t=this;Object(a.c)().then(function(e){t.allCustomerList=e.data.list})},getCustomerInvestProjectList:function(){var t=this;this.allProjectList.forEach(function(t){return t.disabled=!1}),Object(c.b)(this.investForm.customerId).then(function(e){t.customerInvestProjectList=e.data;for(var r=function(e){t.customerInvestProjectList.forEach(function(r){r.projectId===t.allProjectList[e].projectId&&(t.allProjectList[e].disabled=!0)})},n=0;n<t.allProjectList.length;n++)r(n)})},addProjectCustomer:function(t){var e=this;this.btnLoading=!0,Object(c.a)(t).then(function(t){200===t.returnCode?(e.$message.success("客户投资信息已录入"),e.btnLoading=!1):(e.$message.error("客户投资信息录入失败"),e.btnLoading=!1)})},submitForm:function(){var t=this;this.$refs.investForm.validate(function(e){if(!e)return console.error("error submit!!"),!1;t.isEdit||t.addProjectCustomer(t.investForm)})},resetForm:function(t){this.$refs[t].resetFields(),this.investForm.rate=""},getRateRange:function(){var t=this,e=this.investForm.projectId,r=this.investForm.investMoney;""!=e&&""!=r&&(o()(r)?Object(u.g)(e,r).then(function(e){e.data?t.investForm.rate=e.data:t.investForm.rate="投资金额不在该项目的利息区间内"}):this.$message.error("投资金额必须为数字"))}}},m=(r("W0Vi"),r("KHd+")),f=Object(m.a)(d,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("el-card",{attrs:{shadow:"hover"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[t._v("客户投资")]),t._v(" "),r("router-link",{attrs:{to:"/customer/index"}},[r("el-button",{staticStyle:{float:"right",padding:"8px 10px"},attrs:{type:"info",size:"small",icon:"el-icon-back"}},[t._v("返回客户列表")])],1)],1),t._v(" "),r("el-form",{ref:"investForm",attrs:{model:t.investForm,rules:t.rules,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"投资人",prop:"customerId"}},[r("el-col",{attrs:{span:20}},[r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.investForm.customerId,callback:function(e){t.$set(t.investForm,"customerId",e)},expression:"investForm.customerId"}},t._l(t.allCustomerList,function(e){return r("el-option",{key:e.customerId,attrs:{label:e.customerName,value:e.customerId}},[r("span",{staticStyle:{float:"left"}},[t._v(t._s(e.customerName))]),t._v(" "),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.idCard))])])}),1)],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"投资人身份证件号",prop:"customerIdCard"}},[r("el-col",{attrs:{span:20}},[r("el-input",{attrs:{readonly:!0},model:{value:t.investForm.customerIdCard,callback:function(e){t.$set(t.investForm,"customerIdCard",e)},expression:"investForm.customerIdCard"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"投资项目",prop:"projectId"}},[r("el-col",{attrs:{span:20}},[r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.investForm.projectId,callback:function(e){t.$set(t.investForm,"projectId",e)},expression:"investForm.projectId"}},t._l(t.allProjectList,function(t){return r("el-option",{key:t.projectId,attrs:{disabled:t.disabled,label:t.projectName,value:t.projectId}})}),1)],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"投资金额",prop:"investMoney"}},[r("el-col",{attrs:{span:20}},[r("el-input",{attrs:{clearable:""},model:{value:t.investForm.investMoney,callback:function(e){t.$set(t.investForm,"investMoney",t._n(e))},expression:"investForm.investMoney"}})],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"打款时间",prop:"investTime"}},[r("el-col",{attrs:{span:20}},[r("div",{staticClass:"block"},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期时间",align:"right","value-format":"yyyy-MM-dd",format:"yyyy-MM-dd"},model:{value:t.investForm.investTime,callback:function(e){t.$set(t.investForm,"investTime",e)},expression:"investForm.investTime"}})],1)])],1),t._v(" "),r("el-form-item",{attrs:{label:"利率"}},[r("el-tag",{attrs:{effect:"dark"},domProps:{textContent:t._s(t.investForm.rate)},model:{value:t.investForm.rate,callback:function(e){t.$set(t.investForm,"rate",e)},expression:"investForm.rate"}})],1),t._v(" "),r("br"),t._v(" "),r("el-form-item",[r("el-row",[r("el-button",{attrs:{type:"warning",icon:"el-icon-refresh"},on:{click:function(e){return t.resetForm("investForm")}}},[t._v("重置")]),t._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-success",loading:t.btnLoading},on:{click:function(e){return t.submitForm("addProjectCustomer")}}},[t._v("保存")])],1)],1)],1)],1)],1)],1)},[],!1,null,null,null);e.default=f.exports},i7jY:function(t,e,r){"use strict";r.d(e,"a",function(){return o}),r.d(e,"d",function(){return s}),r.d(e,"c",function(){return i}),r.d(e,"b",function(){return a});var n=r("t3Un");function o(t){return Object(n.a)({url:"/projectCustomer/insert",method:"post",data:t})}function s(t){return Object(n.a)({url:"/projectCustomer/getInvestCustomersByProjectId",method:"get",params:{projectId:t}})}function i(t,e){return Object(n.a)({url:"/projectCustomer/getCustomersInProjectPhase",method:"get",params:{projectId:t,phase:e}})}function a(t){return Object(n.a)({url:"/projectCustomer/getCustomerInvestProject",method:"get",params:{customerId:t}})}}}]);
//# sourceMappingURL=2.c754f7848da2c2292357.js.map